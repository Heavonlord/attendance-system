{% extends "base.html" %}

{% block content %}
<h2>Manage Enrollments - {{ course.name }}</h2>
<p class="text-muted">Course Code: {{ course.code }}</p>

<div class="card">
    <div class="card-body">
        <form method="POST">
            <div class="mb-3">
                <button type="submit" class="btn btn-primary">
                    ðŸ’¾ Save Enrollments
                </button>
                <a href="{{ url_for('main.teacher_dashboard') }}" class="btn btn-secondary">
                    Cancel
                </a>
                <button type="button" class="btn btn-success" onclick="selectAll()">
                    âœ“ Select All
                </button>
                <button type="button" class="btn btn-warning" onclick="deselectAll()">
                    âœ— Deselect All
                </button>
            </div>
            
            <h4 class="mb-3">Available Students</h4>
            
            <div class="row">
                {% for student in all_students %}
                <div class="col-md-4 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" 
                               name="students" value="{{ student.id }}" 
                               id="student_{{ student.id }}"
                               {% if student.id in enrolled_student_ids %}checked{% endif %}>
                        <label class="form-check-label" for="student_{{ student.id }}">
                            <strong>{{ student.roll_no or 'N/A' }}</strong> - {{ student.username }}
                            <br>
                            <small class="text-muted">{{ student.email }}</small>
                        </label>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            {% if not all_students %}
            <p class="text-muted">No students found in the system.</p>
            {% endif %}
        </form>
    </div>
</div>

<script>
function selectAll() {
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = true);
}

function deselectAll() {
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
}
</script>
{% endblock %}
